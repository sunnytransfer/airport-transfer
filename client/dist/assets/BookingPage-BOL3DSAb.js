import{r as c,u as g,j as e}from"./react-vendor-DX8DjTp6.js";import{S as v}from"./index-CdnltzCI.js";import{v as u,f as j,e as k,i as y}from"./formatCurrency-BdKPMLAs.js";import"./vendor-DFPNiMdV.js";import"./axios-C0Zqfgkc.js";const d={pickup:"",dropoff:"",date:"",pax:2},p="booking:draft";function b(){try{const s=sessionStorage.getItem(p);if(s)return{...d,...JSON.parse(s)}}catch{}return{...d}}function S(){const[s,t]=c.useState(b);return{draft:s,actions:{set(o,n){t(a=>{const l={...a,[o]:n};return sessionStorage.setItem(p,JSON.stringify(l)),l})},reset(){sessionStorage.removeItem(p),t({...d})}}}}function D(s){const t=new Date(s),r=new Date;return t.getTime()-r.getTime()>24*60*60*1e3}function I(s){const t={};if(s.pickup.trim()||(t.pickup="Pickup is required"),s.dropoff.trim()||(t.dropoff="Dropoff is required"),s.date?D(s.date)||(t.date="Date not available"):t.date="Date is required",(!Number.isFinite(s.pax)||s.pax<1)&&(t.pax="Passengers must be at least 1"),!s.vehicleId)t.vehicleId="Select vehicle";else{const o=u.find(n=>n.id===s.vehicleId);o&&s.pax>o.capacity&&(t.pax="Too many passengers for vehicle")}return{ok:Object.keys(t).length===0,errors:t}}function R(){const s=g(),{draft:t,actions:r}=S(),[o,n]=c.useState({}),[a,l]=c.useState(!1),f=c.useRef(null);c.useEffect(()=>{var i;(i=f.current)==null||i.focus()},[]);const m=i=>{if(i.preventDefault(),a)return;const{ok:h,errors:x}=I(t);n(x),h?(l(!0),sessionStorage.setItem("booking:draft",JSON.stringify(t)),s("/booking/confirm")):l(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(v,{title:"Booking",description:"Start your transfer booking",canonicalPath:"/booking"}),e.jsxs("main",{style:{padding:16,maxWidth:720,margin:"0 auto"},children:[e.jsx("h1",{children:"Booking"}),a&&e.jsx("div",{style:{opacity:.6},children:"Preparing booking…"}),e.jsx("form",{onSubmit:m,children:e.jsxs("div",{style:{display:"grid",gap:12},children:[e.jsxs("label",{children:["Pickup location",e.jsxs("select",{name:"pickup",style:{width:"100%"},value:t.pickup,onChange:i=>r.set("pickup",i.target.value),children:[e.jsx("option",{value:"",children:"Select pickup"}),e.jsx("option",{value:"Dalaman Airport",children:"Dalaman Airport"}),e.jsx("option",{value:"Bodrum Airport",children:"Bodrum Airport"})]}),o.pickup&&e.jsx("small",{style:{color:"red"},children:o.pickup})]}),e.jsxs("label",{children:["Dropoff location",e.jsxs("select",{name:"dropoff",style:{width:"100%"},value:t.dropoff,onChange:i=>r.set("dropoff",i.target.value),children:[e.jsx("option",{value:"",children:"Select dropoff"}),e.jsx("option",{value:"Marmaris",children:"Marmaris"}),e.jsx("option",{value:"Icmeler",children:"Icmeler"})]}),o.dropoff&&e.jsx("small",{style:{color:"red"},children:o.dropoff})]}),e.jsxs("label",{children:["Date",e.jsx("input",{name:"date",type:"date",style:{width:"100%"},value:t.date,onChange:i=>r.set("date",i.target.value)}),o.date&&e.jsx("small",{style:{color:"red"},children:o.date})]}),e.jsxs("label",{children:["Passengers",e.jsx("input",{name:"pax",type:"number",min:1,style:{width:"100%"},value:t.pax,onChange:i=>r.set("pax",Number(i.target.value))}),o.pax&&e.jsx("small",{style:{color:"red"},children:o.pax})]}),e.jsxs("label",{children:["Vehicle",e.jsxs("select",{value:t.vehicleId||"",onChange:i=>r.set("vehicleId",i.target.value),style:{width:"100%"},children:[e.jsx("option",{value:"",children:"Select vehicle"}),u.map(i=>e.jsxs("option",{value:i.id,children:[i.name," (max ",i.capacity,")"]},i.id))]})]}),e.jsxs("p",{style:{fontWeight:"bold"},children:["Price estimate: ",j(k(t))]}),!y(t)&&e.jsx("small",{children:"Route not in fixed list — estimated price shown."}),e.jsx("button",{type:"submit",disabled:a,children:a?"Processing...":"Continue"})]})})]})]})}export{R as default};
