import{r as u,j as e}from"./react-vendor-DX8DjTp6.js";import{u as M}from"./index-CdnltzCI.js";import{M as O,t as F,X as H}from"./vendor-DFPNiMdV.js";/* empty css              */import"./axios-C0Zqfgkc.js";const Y=({isOpen:r,onClose:l,booking:s,type:i,settings:h})=>{const[a,n]=u.useState("");u.useEffect(()=>{r&&s&&t()},[r,s,i]);const t=()=>{const o={id:s.id,name:s.customer_name||"Guest",route:`${s.pickup_location} -> ${s.dropoff_location}`,date:new Date(s.pickup_time).toLocaleString("tr-TR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}),pax:s.passenger_count,childSeats:s.baby_seats||0,hotel:s.hotel_name||"Not specified",flight:s.flight_number||"-",payableTotal:s.price,businessWhatsapp:(h==null?void 0:h.whatsapp)||"+90 555 123 4567",businessEmail:(h==null?void 0:h.email)||"info@marmaristrip.com"},d={...o,phone:s.phone,note:s.note||"-"};let p="";i==="whatsapp_customer"?p=`Merhaba ${o.name},

Transfer rezervasyonunuz onaylanmÄ±ÅŸtÄ±r. âœ…

Rezervasyon No: #${o.id}
ðŸ“… Tarih/Saat: ${o.date}
ðŸš— GÃ¼zergah: ${o.route}
ðŸ‘¥ Yolcu: ${o.pax}
ðŸ‘¶ Ã‡ocuk KoltuÄŸu: ${o.childSeats}
ðŸ¨ Otel/Adres: ${o.hotel}
âœˆï¸ UÃ§uÅŸ No: ${o.flight}

ðŸ’° Ã–denecek Tutar: Â£${o.payableTotal} (Nakit/VarÄ±ÅŸta)

SorularÄ±nÄ±z iÃ§in bizimle iletiÅŸime geÃ§ebilirsiniz:
WhatsApp: ${o.businessWhatsapp}
Email: ${o.businessEmail}

Ä°yi yolculuklar dileriz!`:i==="whatsapp_driver"?p=`ðŸ›‘ *YENÄ° GÃ–REV / DRIVER JOB* ðŸ›‘

ID: #${d.id}
Tarih: ${d.date}

GÃ¼zergah: ${d.route}
Otel: ${d.hotel}
UÃ§uÅŸ: ${d.flight}

Yolcu: ${d.name}
KiÅŸi SayÄ±sÄ±: ${d.pax}
Ã‡ocuk KoltuÄŸu: ${d.childSeats}
ðŸ“ž Tel: ${d.phone}

ðŸ“ MÃ¼ÅŸteri Notu: ${d.note}

LÃ¼tfen onaylayÄ±n.`:i==="email_customer"&&(p=`Subject: Booking Confirmation #${o.id}

Dear ${o.name},

Your transfer booking has been confirmed. âœ…

Booking ID: #${o.id}
Date & Time: ${o.date}
Route: ${o.route}
Passengers: ${o.pax}
Child Seats: ${o.childSeats}
Hotel/Address: ${o.hotel}
Flight Number: ${o.flight}

Total Payable: Â£${o.payableTotal} (Pay on Arrival)

If you have any questions, please contact us:
WhatsApp: ${o.businessWhatsapp}
Email: ${o.businessEmail}

Best regards,
MarmarisTrip Team`),n(p)},x=()=>{const o=encodeURIComponent(a);if(i==="whatsapp_customer"){let d=s.phone.replace(/[^0-9]/g,"");window.open(`https://wa.me/${d}?text=${o}`,"_blank")}else if(i==="whatsapp_driver")window.open(`https://wa.me/?text=${o}`,"_blank");else if(i==="email_customer"){const d=`Booking Confirmation #${s.id}`,p=encodeURIComponent(a.replace(/^Subject:.*\n+/,""));window.open(`mailto:${s.email}?subject=${encodeURIComponent(d)}&body=${p}`,"_blank")}l()};return r?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:e.jsxs("div",{style:{background:"white",padding:"24px",borderRadius:"8px",width:"90%",maxWidth:"500px",display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h3",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px"},children:[i.includes("whatsapp")?e.jsx(O,{size:20,color:"#25D366"}):e.jsx(F,{size:20,color:"#007bff"}),i==="whatsapp_driver"?"Driver Message Preview":"Customer Message Preview"]}),e.jsx("button",{onClick:l,style:{border:"none",background:"transparent",cursor:"pointer"},children:e.jsx(H,{size:20})})]}),e.jsx("div",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"0.9rem",whiteSpace:"pre-wrap",maxHeight:"300px",overflowY:"auto",border:"1px solid #ddd"},children:a}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"10px"},children:[e.jsx("button",{onClick:l,style:{padding:"8px 16px",borderRadius:"4px",border:"1px solid #ccc",background:"white",cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:x,style:{padding:"8px 24px",borderRadius:"4px",border:"none",background:i.includes("whatsapp")?"#25D366":"#007bff",color:"white",fontWeight:"bold",cursor:"pointer"},children:"Send Now"})]})]})}):null},V=()=>{const[r,l]=u.useState("company"),{settings:s,updateSetting:i}=M(),h=[{id:"company",label:"Company Info"},{id:"content",label:"Content & SEO"},{id:"media",label:"Media Library"},{id:"messages",label:"Messages"}],a=({label:t,field:x,placeholder:o})=>e.jsxs("div",{className:"form-group",style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"500"},children:t}),e.jsx("input",{className:"form-input",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px"},value:s[x]||"",onChange:d=>i(x,d.target.value),placeholder:o})]}),n=({label:t,field:x,placeholder:o,height:d="80px"})=>e.jsxs("div",{className:"form-group",style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"500"},children:t}),e.jsx("textarea",{className:"form-input",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px",height:d},value:s[x]||"",onChange:p=>i(x,p.target.value),placeholder:o})]});return e.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[e.jsx("h2",{style:{fontSize:"1.4rem",color:"#003580",marginBottom:"15px"},children:"Site Control Center"}),e.jsx("div",{style:{display:"flex",gap:"5px",marginBottom:"20px",borderBottom:"1px solid #eee",overflowX:"auto"},children:h.map(t=>e.jsx("button",{onClick:()=>l(t.id),style:{padding:"10px 20px",background:r===t.id?"#003580":"transparent",color:r===t.id?"white":"#666",border:"none",borderRadius:"4px 4px 0 0",cursor:"pointer",fontWeight:"600",whiteSpace:"nowrap"},children:t.label},t.id))}),r==="company"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{style:{gridColumn:"span 2"},children:[e.jsx("h3",{style:{fontSize:"1rem",borderBottom:"1px solid #eee",paddingBottom:"5px",marginBottom:"15px"},children:"Identity"}),e.jsx(a,{label:"Company Name",field:"company_name",placeholder:"MarmarisTrip"}),e.jsx(a,{label:"Site Header Title",field:"siteTitle",placeholder:"MarmarisTrip"})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"1rem",borderBottom:"1px solid #eee",paddingBottom:"5px",marginBottom:"15px"},children:"Contact"}),e.jsx(a,{label:"Phone (International Format, no +)",field:"company_phone",placeholder:"905551234567"}),e.jsx(a,{label:"WhatsApp (clean number)",field:"company_whatsapp",placeholder:"905551234567"}),e.jsx(a,{label:"Public Email",field:"company_email",placeholder:"info@marmaristrip.com"})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"1rem",borderBottom:"1px solid #eee",paddingBottom:"5px",marginBottom:"15px"},children:"Notifications"}),e.jsx(a,{label:"Admin Notification Email",field:"admin_notification_email",placeholder:"admin@marmaristrip.com"}),e.jsx("p",{style:{fontSize:"0.8rem",color:"#666"},children:"Where new booking alerts are sent."})]}),e.jsxs("div",{style:{gridColumn:"span 2"},children:[e.jsx("h3",{style:{fontSize:"1rem",borderBottom:"1px solid #eee",paddingBottom:"5px",marginBottom:"15px"},children:"Social Media Links"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx(a,{label:"Facebook URL",field:"social_facebook",placeholder:"https://facebook.com/..."}),e.jsx(a,{label:"Instagram URL",field:"social_instagram",placeholder:"https://instagram.com/..."}),e.jsx(a,{label:"TikTok URL",field:"social_tiktok",placeholder:"https://tiktok.com/..."}),e.jsx(a,{label:"YouTube URL",field:"social_youtube",placeholder:"https://youtube.com/..."})]})]})]}),r==="content"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{style:{gridColumn:"span 2"},children:[e.jsx(a,{label:"Home Hero Title",field:"homeTitle",placeholder:"Your Journey, Your Experience"}),e.jsx(a,{label:"Home Hero Subtitle",field:"homeSubtitle",placeholder:"Airport Taxi & Excursions"}),e.jsx(a,{label:"Footer Text",field:"footerText",placeholder:"Â© 2024 Private Transfer Service..."})]}),e.jsxs("div",{style:{gridColumn:"span 2",marginTop:"20px"},children:[e.jsx("h3",{style:{fontSize:"1rem",borderBottom:"1px solid #eee",paddingBottom:"5px",marginBottom:"15px"},children:"SEO Defaults"}),e.jsx(a,{label:"Global Meta Title",field:"seoTitle",placeholder:"Marmaris Airport Transfers"}),e.jsx(n,{label:"Global Meta Description",field:"seoDescription",placeholder:"Book reliable transfers..."})]})]}),r==="media"&&e.jsx(G,{}),r==="messages"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{style:{padding:"15px",background:"#f8f9fa",borderRadius:"4px"},children:[e.jsx("h3",{style:{fontSize:"1rem",marginBottom:"15px"},children:"WhatsApp Templates"}),e.jsxs("p",{style:{fontSize:"0.85rem",color:"#666",marginBottom:"10px"},children:["Available variables: ","{customer}",", ","{pickup_time}",", ","{pickup}",", ","{dropoff}",", ","{driver_name}",", ","{driver_phone}",", ","{price}"]}),e.jsx(n,{label:"Customer Confirmation Template",field:"wa_template_confirmation",height:"100px",placeholder:"Hello {customer}, your booking is confirmed..."}),e.jsx(n,{label:"Driver Assignment Template (to Customer)",field:"wa_template_driver_assign",height:"100px",placeholder:"Your driver {driver_name} has been assigned..."})]}),e.jsxs("div",{style:{padding:"15px",background:"#f8f9fa",borderRadius:"4px"},children:[e.jsx("h3",{style:{fontSize:"1rem",marginBottom:"15px"},children:"Email Templates"}),e.jsx(a,{label:"Confirmation Subject",field:"email_subject_confirmation",placeholder:"Booking Confirmation"}),e.jsx(n,{label:"Confirmation Body (HTML supported)",field:"email_body_confirmation",height:"150px",placeholder:"<p>Dear {customer}...</p>"})]})]})]})},G=()=>{const[r,l]=u.useState([]);u.useEffect(()=>{fetch("/api/media").then(i=>i.json()).then(i=>{i.data&&l(i.data)})},[]);const s=i=>{const h=i.target.files[0];if(!h)return;const a=new FormData;a.append("image",h),fetch("/api/upload",{method:"POST",body:a}).then(n=>n.json()).then(n=>{n.url&&fetch("/api/media").then(t=>t.json()).then(t=>t.data&&l(t.data))})};return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"20px",border:"2px dashed #ccc",padding:"20px",textAlign:"center",borderRadius:"8px"},children:[e.jsx("p",{children:"Drag & Drop or Click to Upload"}),e.jsx("input",{type:"file",onChange:s})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(100px, 1fr))",gap:"10px"},children:r.map(i=>e.jsxs("div",{style:{position:"relative",border:"1px solid #ddd",borderRadius:"4px",overflow:"hidden"},children:[e.jsx("img",{src:i.optimized_path||`/uploads/${i.filename}`,alt:"upload",style:{width:"100%",height:"80px",objectFit:"cover"}}),e.jsx("button",{style:{width:"100%",border:"none",background:"#f8f9fa",fontSize:"0.8rem",cursor:"pointer",padding:"4px"},onClick:()=>{navigator.clipboard.writeText(i.optimized_path||`/uploads/${i.filename}`),alert("URL Copied!")},children:"Copy URL"})]},i.id))})]})},J=[{name:"Unassigned",phone:""},{name:"Ahmet Yilmaz",phone:"905551112233"},{name:"Mehmet Demir",phone:"905552223344"},{name:"Ali Kaya",phone:"905553334455"},{name:"Mustafa Can",phone:"905554445566"}],I=({status:r})=>{let l="#555",s="#eee";const i=(r||"pending").toLowerCase();return(i==="confirmed"||i==="approved")&&(l="#2e7d32",s="#e8f5e9"),i==="completed"&&(l="#1565c0",s="#e3f2fd"),i==="cancelled"&&(l="#c62828",s="#ffebee"),i==="pending"&&(l="#ef6c00",s="#fff3e0"),e.jsx("span",{style:{display:"inline-block",padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",color:l,background:s,textTransform:"uppercase",letterSpacing:"0.5px"},children:r||"Pending"})},K=({booking:r,onAssign:l})=>{const[s,i]=u.useState(!1),[h,a]=u.useState(r.driver_name||""),n=t=>{t.stopPropagation(),l(r.id,h),i(!1)};return s?e.jsxs("div",{style:{display:"flex",gap:"5px"},onClick:t=>t.stopPropagation(),children:[e.jsxs("select",{value:h,onChange:t=>a(t.target.value),style:{padding:"4px",fontSize:"12px",borderRadius:"4px",border:"1px solid #ccc"},children:[e.jsx("option",{value:"",children:"Select Driver..."}),J.map(t=>e.jsx("option",{value:t.name,children:t.name},t.name))]}),e.jsx("button",{onClick:n,style:{fontSize:"10px",padding:"4px 8px",background:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"âœ“"}),e.jsx("button",{onClick:t=>{t.stopPropagation(),i(!1)},style:{fontSize:"10px",padding:"4px 8px",background:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"âœ•"})]}):e.jsx("div",{onClick:t=>{t.stopPropagation(),i(!0)},style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:r.driver_name?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{fontSize:"12px"},children:"ðŸ‘¤"}),e.jsx("span",{style:{fontWeight:"600",color:"#003580",fontSize:"13px"},children:r.driver_name})]}):e.jsx("span",{style:{color:"#999",fontSize:"12px",fontStyle:"italic",borderBottom:"1px dashed #ccc"},children:"+ Assign"})})},X=()=>{const[r,l]=u.useState([]),[s,i]=u.useState(!0);u.useEffect(()=>{h()},[]);const h=()=>{i(!0),fetch("/api/pricing-rules").then(t=>t.json()).then(t=>{l(t.data||[]),i(!1)}).catch(()=>i(!1))},a=t=>{fetch(`/api/pricing-rules/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(x=>x.json()).then(()=>alert("Saved!"))},n=(t,x,o)=>{l(r.map(d=>{if(d.id!==t)return d;const p={...d,[x]:o};return x==="one_way_price"&&(p.return_price=Math.round((parseFloat(o)||0)*2*.95)),p}))};return s?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px"},children:[e.jsx("h3",{children:"Pricing Rules"}),e.jsxs("table",{className:"data-table",style:{width:"100%",marginTop:"15px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{textAlign:"left",background:"#f8f9fa"},children:[e.jsx("th",{style:{padding:"10px"},children:"Pax"}),e.jsx("th",{style:{padding:"10px"},children:"Vehicle"}),e.jsx("th",{style:{padding:"10px"},children:"One Way (Â£)"}),e.jsx("th",{style:{padding:"10px"},children:"Return (Â£)"}),e.jsx("th",{style:{padding:"10px"},children:"Action"})]})}),e.jsx("tbody",{children:r.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{style:{padding:"10px"},children:[t.min_pax,"-",t.max_pax]}),e.jsx("td",{style:{padding:"10px"},children:e.jsx("input",{value:t.vehicle_name,onChange:x=>n(t.id,"vehicle_name",x.target.value),style:{padding:"4px"}})}),e.jsx("td",{style:{padding:"10px"},children:e.jsx("input",{type:"number",value:t.one_way_price,onChange:x=>n(t.id,"one_way_price",x.target.value),style:{width:"60px",padding:"4px"}})}),e.jsx("td",{style:{padding:"10px"},children:e.jsx("input",{type:"number",value:t.return_price,readOnly:!0,style:{width:"60px",background:"#eee",padding:"4px"}})}),e.jsx("td",{style:{padding:"10px"},children:e.jsx("button",{className:"btn-success",onClick:()=>a(t),style:{padding:"6px 12px",background:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Save"})})]},t.id))})]})]})},T=({title:r,bookings:l,type:s,onAction:i,onAssignDriver:h})=>{if(!l||l.length===0)return null;let a="#003580";return s==="return"&&(a="#d32f2f"),s==="arrival"&&(a="#0288d1"),s==="asap"&&(a="#ed6c02"),e.jsxs("div",{style:{marginBottom:"20px",background:"white",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"12px 15px",background:a,color:"white",fontWeight:"bold",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:r}),e.jsx("span",{style:{background:"rgba(255,255,255,0.2)",padding:"2px 8px",borderRadius:"10px",fontSize:"12px"},children:l.length})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[e.jsx("thead",{style:{background:"#f8f9fa",borderBottom:"2px solid #dee2e6",color:"#666"},children:e.jsxs("tr",{children:[e.jsx("th",{style:{padding:"12px"},children:"Time"}),e.jsx("th",{style:{padding:"12px"},children:"Route"}),e.jsx("th",{style:{padding:"12px"},children:"Customer"}),e.jsx("th",{style:{padding:"12px"},children:"Pax"}),e.jsx("th",{style:{padding:"12px"},children:"Price"}),e.jsx("th",{style:{padding:"12px"},children:"Driver"}),e.jsx("th",{style:{padding:"12px"},children:"Status"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:l.map(n=>{var x,o;const t=parseFloat(n.price||0);return e.jsxs("tr",{style:{borderBottom:"1px solid #eee"},onClick:()=>i(n,"detail"),children:[e.jsxs("td",{style:{padding:"12px",fontWeight:"bold",minWidth:"80px"},children:[new Date(n.pickup_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),n.flight_time&&e.jsxs("div",{style:{fontSize:"10px",color:"#666",marginTop:"4px"},children:["âœˆ ",new Date(n.flight_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsx("td",{style:{padding:"12px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",maxWidth:"180px",fontSize:"12px"},children:[e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"80px"},title:n.pickup_location,children:(x=n.pickup_location)==null?void 0:x.split(",")[0]}),e.jsx("span",{style:{color:"#999"},children:"âžœ"}),e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"80px"},title:n.dropoff_location,children:(o=n.dropoff_location)==null?void 0:o.split(",")[0]})]})}),e.jsxs("td",{style:{padding:"12px"},children:[e.jsx("div",{style:{fontWeight:"500"},children:n.customer_name}),e.jsx("div",{style:{fontSize:"11px",color:"#666"},children:n.phone})]}),e.jsx("td",{style:{padding:"12px",textAlign:"center"},children:n.passenger_count}),e.jsx("td",{style:{padding:"12px",fontWeight:"bold",color:t>0?"#2e7d32":"#999"},children:t>0?`Â£${t}`:e.jsx("span",{style:{fontSize:"10px",background:"#eee",padding:"2px 4px",borderRadius:"4px"},children:"UNPRICED"})}),e.jsx("td",{style:{padding:"12px"},children:e.jsx(K,{booking:n,onAssign:h})}),e.jsx("td",{style:{padding:"12px"},children:e.jsx(I,{status:n.status})}),e.jsxs("td",{style:{padding:"12px",textAlign:"right"},children:[e.jsx("button",{onClick:d=>{d.stopPropagation(),i(n,"whatsapp")},style:{padding:"6px 10px",background:"#25D366",color:"white",border:"none",borderRadius:"4px",marginRight:"5px",cursor:"pointer"},children:"WA"}),e.jsx("button",{onClick:d=>{d.stopPropagation(),i(n,"detail")},style:{padding:"6px 10px",background:"#003580",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"View"})]})]},n.id)})})]})})]})},q=({booking:r,onClose:l})=>r?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",zIndex:3e3,display:"flex",justifyContent:"center",alignItems:"center",backdropFilter:"blur(2px)"},children:e.jsxs("div",{style:{background:"white",borderRadius:"8px",width:"90%",maxWidth:"600px",boxShadow:"0 20px 50px rgba(0,0,0,0.3)",overflow:"hidden",animation:"fadeIn 0.2s"},children:[e.jsxs("div",{style:{padding:"15px 20px",background:"#f8f9fa",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h3",{style:{margin:0,fontSize:"1.2rem",color:"#333"},children:["Booking #",r.id]}),e.jsx("button",{onClick:l,style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"#666"},children:"Ã—"})]}),e.jsxs("div",{style:{padding:"20px",maxHeight:"70vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.8rem",color:"#888",textTransform:"uppercase"},children:"Customer"}),e.jsx("div",{style:{fontWeight:"bold",fontSize:"1.1rem"},children:r.customer_name}),e.jsx("div",{style:{color:"#003580"},children:r.phone}),e.jsx("div",{style:{color:"#666",fontSize:"0.9rem"},children:r.email})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.8rem",color:"#888",textTransform:"uppercase"},children:"Status"}),e.jsx("div",{children:e.jsx(I,{status:r.status})}),e.jsxs("div",{style:{marginTop:"10px"},children:[e.jsx("label",{style:{fontSize:"0.8rem",color:"#888",textTransform:"uppercase"},children:"Price"}),e.jsx("div",{style:{fontWeight:"bold",fontSize:"1.2rem",color:"#2e7d32"},children:r.price||"Unpriced"})]})]})]}),e.jsx("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid #eee"}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.8rem",color:"#888",textTransform:"uppercase"},children:"Pickup"}),e.jsx("div",{style:{fontWeight:"600"},children:new Date(r.pickup_time).toLocaleString()}),e.jsx("div",{children:r.pickup_location}),r.flight_time&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"#666"},children:["âœˆ Flight: ",new Date(r.flight_time).toLocaleTimeString()]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.8rem",color:"#888",textTransform:"uppercase"},children:"Dropoff"}),e.jsx("div",{children:r.dropoff_location}),r.hotel_name&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"#666"},children:["ðŸ¨ ",r.hotel_name]})]})]}),r.note&&e.jsxs("div",{style:{marginTop:"20px",background:"#fff3cd",padding:"10px",borderRadius:"4px",border:"1px solid #ffeeba"},children:[e.jsx("strong",{style:{color:"#856404"},children:"Notes:"})," ",r.note]})]}),e.jsxs("div",{style:{padding:"15px 20px",background:"#f8f9fa",borderTop:"1px solid #eee",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[e.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"white",border:"1px solid #ccc",borderRadius:"4px",cursor:"pointer"},children:"Close"}),e.jsx("button",{style:{padding:"8px 16px",background:"#003580",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Open Full Booking"})]})]})}):null,re=()=>{const[r,l]=u.useState([]),[s,i]=u.useState(!0),{settings:h}=M(),[a,n]=u.useState(null),[t,x]=u.useState(!1),[o,d]=u.useState("whatsapp_customer"),[p,k]=u.useState("today"),[j,P]=u.useState("dashboard");u.useEffect(()=>{C();const c=setInterval(C,3e4);return()=>clearInterval(c)},[]);const C=()=>{fetch("/api/bookings?status=active").then(c=>c.json()).then(c=>{c.data&&l(c.data),i(!1)}).catch(()=>i(!1))},b=(c,f)=>{fetch(`/api/bookings/${c}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({driver_name:f,status:f?"confirmed":"pending"})}).then(()=>C())},v=(c,f)=>{f==="whatsapp"?(n(c),d("whatsapp_customer"),x(!0)):f==="detail"&&n(c)},g=u.useMemo(()=>{if(!r.length)return{asap:[],todayArrivals:[],todayDepartures:[],tomorrowArrivals:[],tomorrowDepartures:[],totalRevenue:0};const c=new Date,f=new Date(c.getFullYear(),c.getMonth(),c.getDate()),w=new Date(f);w.setDate(w.getDate()+1);const _=new Date(w);_.setDate(_.getDate()+1);const E=new Date(c.getTime()+2*60*60*1e3),D=[],R=[],z=[],A=[],B=[];let $=0;r.forEach(m=>{const y=new Date(m.pickup_time),N=y>=f&&y<w,L=y>=w&&y<_,W=(m.pickup_location||"").toLowerCase().includes("airport"),U=parseFloat((m.price||"0").toString().replace(/[^0-9.]/g,""))||0;y>c&&y<E&&m.status!=="completed"&&m.status!=="cancelled"&&D.push(m),N?(W?R.push(m):z.push(m),m.status!=="cancelled"&&($+=U)):L&&(W?A.push(m):B.push(m))});const S=(m,y)=>new Date(m.pickup_time)-new Date(y.pickup_time);return{asap:D.sort(S),todayArrivals:R.sort(S),todayDepartures:z.sort(S),tomorrowArrivals:A.sort(S),tomorrowDepartures:B.sort(S),totalRevenue:$}},[r]);return e.jsxs("div",{className:"container admin-container",style:{maxWidth:"1400px",margin:"0 auto",padding:"20px"},children:[e.jsx(Y,{isOpen:t,onClose:()=>x(!1),booking:a,type:o,settings:h}),a&&!t&&e.jsx(q,{booking:a,onClose:()=>n(null)}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",borderBottom:"1px solid #eee",paddingBottom:"15px"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:e.jsx("h1",{style:{margin:0,fontSize:"24px",color:"#003580",fontWeight:"bold"},children:"Transport OPS"})}),e.jsx("div",{style:{display:"flex",gap:"5px",background:"#f0f2f5",padding:"5px",borderRadius:"6px"},children:["dashboard","pricing","settings"].map(c=>e.jsx("button",{onClick:()=>P(c),style:{padding:"8px 20px",borderRadius:"4px",border:"none",background:j===c?"white":"transparent",color:j===c?"#003580":"#666",fontWeight:j===c?"bold":"500",boxShadow:j===c?"0 2px 4px rgba(0,0,0,0.1)":"none",cursor:"pointer",textTransform:"capitalize"},children:c},c))})]}),j==="dashboard"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{background:"#003580",color:"white",padding:"20px",borderRadius:"8px",marginBottom:"25px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 4px 12px rgba(0,53,128,0.2)"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"12px",textTransform:"uppercase",opacity:.8,fontWeight:"bold",letterSpacing:"1px"},children:"Live Operations"}),e.jsxs("div",{style:{fontSize:"14px",marginTop:"5px"},children:["System Active â€¢ ",new Date().toLocaleTimeString()]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:"12px",opacity:.8},children:"Today's Revenue"}),e.jsxs("div",{style:{fontSize:"32px",fontWeight:"800"},children:["Â£",g.totalRevenue.toFixed(2)]})]})]}),g.asap.length>0&&e.jsx("div",{style:{marginBottom:"25px",background:"#ffebee",border:"1px solid #ffcdd2",borderRadius:"8px",padding:"5px"},children:e.jsx(T,{title:"ðŸ”¥ ASAP / URGENT (Next 2 Hours)",bookings:g.asap,type:"asap",onAction:v,onAssignDriver:b})}),e.jsxs("div",{style:{display:"flex",gap:"15px",marginBottom:"20px"},children:[e.jsx("button",{onClick:()=>k("today"),style:{padding:"8px 20px",borderRadius:"20px",border:"none",background:p==="today"?"#003580":"#e0e0e0",color:p==="today"?"white":"black",fontWeight:"bold",cursor:"pointer"},children:"Today"}),e.jsx("button",{onClick:()=>k("tomorrow"),style:{padding:"8px 20px",borderRadius:"20px",border:"none",background:p==="tomorrow"?"#003580":"#e0e0e0",color:p==="tomorrow"?"white":"black",fontWeight:"bold",cursor:"pointer"},children:"Tomorrow"}),e.jsx("button",{onClick:()=>k("all"),style:{padding:"8px 20px",borderRadius:"20px",border:"none",background:p==="all"?"#003580":"#e0e0e0",color:p==="all"?"white":"black",fontWeight:"bold",cursor:"pointer"},children:"All Upcoming"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{children:[(p==="today"||p==="all")&&e.jsx(T,{title:"ðŸ›¬ Today Arrivals (Airport -> Hotel)",bookings:g.todayArrivals,type:"arrival",onAction:v,onAssignDriver:b}),(p==="tomorrow"||p==="all")&&e.jsx(T,{title:"ðŸ“… Tomorrow Arrivals",bookings:g.tomorrowArrivals,type:"arrival",onAction:v,onAssignDriver:b})]}),e.jsxs("div",{children:[(p==="today"||p==="all")&&e.jsx(T,{title:"ðŸ›« Today Departures / Returns",bookings:g.todayDepartures,type:"return",onAction:v,onAssignDriver:b}),(p==="tomorrow"||p==="all")&&e.jsx(T,{title:"ðŸ“… Tomorrow Departures",bookings:g.tomorrowDepartures,type:"return",onAction:v,onAssignDriver:b})]})]}),g.todayArrivals.length===0&&g.todayDepartures.length===0&&p==="today"&&e.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#999",background:"white",borderRadius:"8px",border:"1px dashed #ddd"},children:[e.jsx("h3",{children:"No operations scheduled for today."}),e.jsx("p",{children:'Check "Tomorrow" or "All Upcoming" to see future jobs.'})]})]}),j==="pricing"&&e.jsx(X,{}),j==="settings"&&e.jsx(V,{})]})};export{re as default};
